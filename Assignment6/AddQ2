#include <stdio.h>
#include <stdlib.h>

typedef struct CNode {
    int data;
    struct CNode *next;
} CNode;

int parity(int x) {
    int c = 0;
    while (x) { c += x & 1; x >>= 1; }
    return c;
}

void removeEvenParity(CNode **head) {
    if (!(*head)) return;

    CNode *p = *head, *prev = NULL;

    do {
        if (parity(p->data) % 2 == 0) {
            if (p == *head) {
                CNode *last = *head;
                while (last->next != *head) last = last->next;

                if (p->next == p) {
                    *head = NULL;
                    free(p);
                    return;
                }

                last->next = p->next;
                *head = p->next;
                free(p);
                p = *head;
            } else {
                prev->next = p->next;
                free(p);
                p = prev->next;
            }
        } else {
            prev = p;
            p = p->next;
        }
    } while (p != *head);
}
